/*
# # Grock Solarized Side Menu
#
# @copyright 2014 Pascal Hertleif
# @license MIT
*/
(function(){var e,n,t,a,l,r,i;e=Zepto||jQuery,n=function(t,a,l){return a=e(a),(null!=t?t.length:void 0)?(e.each(t,function(t,r){var i,o,s,c;o=e('<li class="'+r.type+'"/>'),"file"===r.type?(s=l.documentPath===r.data.targetPath,s&&(l.currentFileNode&&console.warn("duplicate currentFile"),l.currentFileNode=r),o.append('<a class="label'+(s?" selected":"")+'" href="'+l.relativeRoot+r.data.targetPath+'.html" title="'+r.data.projectPath+'"><span class="text">'+r.data.title+"</span></a>")):o.append('<a class="label" data-path="'+r.data.path+'" href="#"><span class="text">'+r.data.title+"</span></a>"),(null!=(c=r.children)?c.length:void 0)>0&&(i=e('<ol class="children"/>'),o.append(n(r.children,i,l))),a.append(o)}),a):(console.warn("No File Tree!"),a)},t=function(n,a,l){return a=e(a),(null!=n?n.length:void 0)?(e.each(n,function(n,r){var i,o,s;o=e('<li class="'+r.type+'"/>'),o.append('<a class="label" href="#'+r.data.slug+'"><span class="text">'+r.data.title+"</span></a>"),(null!=(s=r.children)?s.length:void 0)>0&&(i=e('<ol class="children"/>'),o.append(t(r.children,i,l))),a.append(o)}),a):(console.warn("no tree",n),a)},r=function(){var n;return n=e('<aside id="side-menu">\n  <nav id="headlines">\n    <details>\n      <summary>This File</summary>\n      <ul class="tools">\n        <li class="search">\n          <input id="search-headlines" type="search" autocomplete="off" placeholder="Search"/>\n        </li>\n      </ul>\n      <ol class="tree" id="headline-tree"></ol>\n    </details>\n  </nav>\n  <nav id="files">\n    <details open>\n      <summary>Files</summary>\n      <ul class="tools">\n        <li class="search">\n          <input id="search-files" type="search" autocomplete="off" placeholder="Search"/>\n        </li>\n      </ul>\n      <ol class="tree" id="file-tree"></ol>\n    </details>\n  </nav>\n</aside>')},l=function(n,t){var a;return a=e('<button type="button" class="toggle-menu">\n  Menu\n</button>'),a.on("click",function(e){return e.preventDefault(),t.toggleClass("open")}),n.prepend(a),n},i=function(n,t){var a,l,r;return l=function(){return function(e,n){var t;return null==n&&(n=100),t&&window.clearTimeout(t),t=window.setTimeout(function(){return t=null,"function"==typeof e?e():void 0},n)}}(),a=function(n,t){return t=t.trim().toLowerCase(),n.find(".matched").removeClass("matched"),""===t?(console.log("stop searching"),void n.removeClass("searching")):(n.addClass("searching"),n.find("a").each(function(n,a){var l;l=e(a),(l.text().toLowerCase().indexOf(t)>-1||l.attr("href").toLowerCase().indexOf(t)>-1)&&(l.addClass("matched"),l.parents("li").children(".label").addClass("matched"))}))},r=null,t.on("keyup search",function(e){var t;return t=e.target.value,t===r||2>t&&""!==t?void 0:(r=t,l(function(){return a(n,r)}))}),t.on("keydown",function(e){return 27===e.keyCode?""===t.val().trim()?t.blur():t.val(""):void 0})},a=function(a,l){var o,s,c;return a?(o=r(l),n(a,o.find("#file-tree"),l),i(o.find("#file-tree"),o.find("#search-files")),(s=l.currentFileNode)&&(c=null,c=s.data.firstHeader?[s.data.firstHeader]:s.outline,t(c,o.find("#headline-tree"),l),i(o.find("#headline-tree"),o.find("#search-headlines"))),o):e("")},e(function(){var n,t;return t={relativeRoot:e('meta[name="groc-relative-root"]').attr("content"),githubURL:e('meta[name="groc-github-url"]').attr("content"),documentPath:e('meta[name="groc-document-path"]').attr("content"),projectPath:e('meta[name="groc-project-path"]').attr("content")},n=a(files,t),n.prependTo(e("body")),l(e("#meta"),n)})}).call(this);