/*
# # Grock Solarized Side Menu
#
# @copyright 2014 Pascal Hertleif
# @license MIT
*/
(function(){var e,t,n,a,l,r,i;e=Zepto||jQuery,t=function(n,a,l){return a=e(a),(null!=n?n.length:void 0)?(e.each(n,function(n,r){var i,o,s,c;o=e('<li class="'+r.type+'"/>'),"file"===r.type?(s=l.documentPath===r.data.targetPath,s&&(l.currentFileNode&&console.warn("duplicate currentFile"),l.currentFileNode=r),o.append('<a class="label'+(s?" selected":"")+'" href="'+l.relativeRoot+r.data.targetPath+'.html" title="'+r.data.projectPath+'"><span class="text">'+r.data.title+"</span></a>")):o.append('<a class="label" data-path="'+r.data.path+'" href="#"><span class="text">'+r.data.title+"</span></a>"),(null!=(c=r.children)?c.length:void 0)>0&&(i=e('<ol class="children"/>'),o.append(t(r.children,i,l))),a.append(o)}),a):(console.warn("No File Tree!"),a)},n=function(t,a,l){return a=e(a),(null!=t?t.length:void 0)?(e.each(t,function(t,r){var i,o,s;o=e('<li class="'+r.type+'"/>'),o.append('<a class="label" href="#'+r.data.slug+'"><span class="text">'+r.data.title+"</span></a>"),(null!=(s=r.children)?s.length:void 0)>0&&(i=e('<ol class="children"/>'),o.append(n(r.children,i,l))),a.append(o)}),a):(console.warn("no tree",t),a)},r=function(){var t;return t=e('<aside id="side-menu">\n  <nav id="headlines">\n    <details>\n      <summary>This File</summary>\n      <ul class="tools">\n        <li class="search">\n          <input id="search-headlines" type="search" autocomplete="off" placeholder="Search"/>\n        </li>\n      </ul>\n      <ol class="tree" id="headline-tree"></ol>\n    </details>\n  </nav>\n  <nav id="files">\n    <details open>\n      <summary>Files</summary>\n      <ul class="tools">\n        <li class="search">\n          <input id="search-files" type="search" autocomplete="off" placeholder="Search"/>\n        </li>\n      </ul>\n      <ol class="tree" id="file-tree"></ol>\n    </details>\n  </nav>\n</aside>')},l=function(t,n){var a;return a=e('<button type="button" class="toggle-menu">\n  Menu\n</button>'),a.on("click",function(e){return e.preventDefault(),n.toggleClass("open")}),t.prepend(a),t},i=function(t,n){var a,l,r;return l=function(){return function(e,t){var n;return null==t&&(t=100),n&&window.clearTimeout(n),n=window.setTimeout(function(){return n=null,"function"==typeof e?e():void 0},t)}}(),a=function(t,n){return n=n.trim().toLowerCase(),t.find(".matched").removeClass("matched"),""===n?(console.log("stop searching"),void t.removeClass("searching")):(t.addClass("searching"),t.find("a").each(function(t,a){var l;l=e(a),(l.text().toLowerCase().indexOf(n)>-1||l.attr("href").toLowerCase().indexOf(n)>-1)&&(l.addClass("matched"),l.parents("li").children(".label").addClass("matched"))}))},r=null,n.on("keyup search",function(e){var n;return n=e.target.value,n===r||2>n&&""!==n?void 0:(r=n,l(function(){return a(t,r)}))}),n.on("keydown",function(e){return 27===e.keyCode?""===n.val().trim()?n.blur():n.val(""):void 0})},a=function(e,a){var l,o,s;return e?(l=r(a),t(e,l.find("#file-tree"),a),i(l.find("#file-tree"),l.find("#search-files")),(o=a.currentFileNode)&&(s=null,s=o.data.firstHeader?[o.data.firstHeader]:o.outline,n(s,l.find("#headline-tree"),a),i(l.find("#headline-tree"),l.find("#search-headlines"))),l):""},e(function(){var t;return t={relativeRoot:e('meta[name="groc-relative-root"]').attr("content"),githubURL:e('meta[name="groc-github-url"]').attr("content"),documentPath:e('meta[name="groc-document-path"]').attr("content"),projectPath:e('meta[name="groc-project-path"]').attr("content")},e.getJSON(""+t.relativeRoot+"toc.json",function(n){var r;return r=a(n,t),r.prependTo(e("body")),l(e("#meta"),r)})})}).call(this);